# BlackBoxGPT ‚Äî Universal AI Assistant (Telegram)

–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π Telegram-–±–æ—Ç —Å –¥–≤—É–º—è —Ä–µ–∂–∏–º–∞–º–∏ (DeepSeek / Pro —Å Perplexity+WEB), –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ —á–µ—Ä–µ–∑ CryptoPay (CryptoBot), —Ä–µ—Ñ–µ—Ä–∞–ª–∫–æ–π, –ª–∏–º–∏—Ç–∞–º–∏, –ø–∞–º—è—Ç—å—é –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–º –æ—Ç–≤–µ—Ç–∞.

## 1) –ß—Ç–æ —É–º–µ–µ—Ç (Level 1‚Äì3)

- üß† **–ï–¥–∏–Ω—ã–π –º–æ–∑–≥**: –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞ (SQLite), –ø—Ä–æ—Å—Ç–∞—è ‚Äú–ø–∞–º—è—Ç—å‚Äù + —Å—Ç–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- üí¨ **–û–¥–∏–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –≤—Å—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è —á–µ—Ä–µ–∑ –Ω–∏–∂–Ω–µ–µ –º–µ–Ω—é (ReplyKeyboard).
- üí∞ **–ü–æ–¥–ø–∏—Å–∫–∏ + —Ä–µ—Ñ–µ—Ä–∞–ª–∫–∞**:
  - CryptoPay (CryptoBot) ‚Äî USDT, –∞–≤—Ç–æ-–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ webhook –∏ –∞–≤—Ç–æ-–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤.
  - –†–µ—Ñ-—Å—Å—ã–ª–∫–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–º –∏ Premium.
- üéØ **–ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Å—Ç–∏–ª—å**: –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π/—ç–º–æ–¥–∑–∏/–º–∞—Ç ‚Üí –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç–∏–ª—è –≤ prompt.
- üß† **–†–µ–∂–∏–º—ã**:
  - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π ‚Äî DeepSeek (–±–µ–∑ WEB)
  - –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π ‚Äî DeepSeek + Perplexity (WEB-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ), —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è –≤—ã–¥–∞—á–∞

**–í–∞–∂–Ω–æ–µ:** –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–æ–∫ –Ω–µ—Ç, –∫—Ä–æ–º–µ –æ–¥–Ω–æ–π ‚Äî `‚û°Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å` –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.

---

## 2) –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (–ª–æ–∫–∞–ª—å–Ω–æ)

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.10+
- Telegram Bot Token
- DeepSeek API key (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- Perplexity API key (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è WEB-—Ä–µ–∂–∏–º–∞)
- CryptoPay API token (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –æ–ø–ª–∞—Ç—ã)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
git clone <your_repo_url>
cd BlackBoxGPT_bot

python -m venv venv
source venv/bin/activate   # Windows: venv\Scripts\activate

pip install -r requirements.txt
cp .env.example .env
```

–û—Ç–∫—Ä–æ–π `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏:
- `BOT_TOKEN`, `BOT_USERNAME`
- `LOG_LEVEL` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, INFO/WARNING/ERROR)
- `DEEPSEEK_API_KEY`
- `PERPLEXITY_API_KEY` (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω WEB)
- `CRYPTOPAY_API_TOKEN`
- `CRYPTOPAY_WEBHOOK_SECRET` (—Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞)

### –ó–∞–ø—É—Å–∫
```bash
python -m bot.main
```

–ü—Ä–æ–≤–µ—Ä–∫–∞:
- `GET http://<host>:8080/health` ‚Üí `{"ok": true}`

---

## 3) Webhook –¥–ª—è CryptoPay

CryptoPay —à–ª—ë—Ç POST –Ω–∞ HTTPS URL.  
–ú–∞—Ä—à—Ä—É—Ç –≤ –ø—Ä–æ–µ–∫—Ç–µ:

```
POST /cryptopay/webhook/<CRYPTOPAY_WEBHOOK_SECRET>
```

**–ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å:**
1) –û—Ç–∫—Ä–æ–π @CryptoBot ‚Üí Crypto Pay ‚Üí My Apps ‚Üí –≤—ã–±–µ—Ä–∏ app ‚Üí Webhooks ‚Üí Enable  
2) –£–∫–∞–∂–∏ URL: `https://YOUR_DOMAIN/cryptopay/webhook/<secret>`

> –ï—Å–ª–∏ —É —Ç–µ–±—è –ø–æ–∫–∞ –Ω–µ—Ç –¥–æ–º–µ–Ω–∞/HTTPS ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π nginx + TLS (Let‚Äôs Encrypt), –ª–∏–±–æ –ø—Ä–æ–∫—Å–∏—Ä—É–π —á–µ—Ä–µ–∑ Cloudflare.

---

## 4) –î–µ–ø–ª–æ–π –Ω–∞ Ubuntu + systemd (–ø—Ä–∏–º–µ—Ä)

### systemd unit
–§–∞–π–ª: `systemd/blackboxgpt.service`

1) –°–∫–æ–ø–∏—Ä—É–π –≤ `/etc/systemd/system/blackboxgpt.service`
2) –ó–∞–ø–æ–ª–Ω–∏ –ø—É—Ç–∏ (WORKDIR) –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3) –í–∫–ª—é—á–∏:
```bash
sudo systemctl daemon-reload
sudo systemctl enable blackboxgpt
sudo systemctl restart blackboxgpt
sudo journalctl -u blackboxgpt -n 200 --no-pager
```

---

## 5) –ì–¥–µ –º–µ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É

- –†–µ–∂–∏–º—ã / –ø—Ä–æ–º—Ç—ã: `services/llm/prompts.py`
- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä (DeepSeek + Perplexity): `services/llm/orchestrator.py`
- –õ–∏–º–∏—Ç—ã: `services/limits.py`
- –û–ø–ª–∞—Ç—ã: `services/crypto_pay.py`, `services/payments.py`, `services/jobs.py`
- –ú–µ–Ω—é/UX —Ç–µ–∫—Å—Ç—ã: `bot/texts.py`, `bot/keyboards.py`

---

## 6) –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- Webhook –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ `crypto-pay-api-signature`.
- –†–µ–∂–∏–º ¬´–º–µ–¥–∏—Ü–∏–Ω–∞¬ª: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –¥–∏—Å–∫–ª–µ–π–º–µ—Ä + –∂—ë—Å—Ç–∫–∏–π –∑–∞–ø—Ä–µ—Ç –Ω–∞ –¥–æ–∑–∏—Ä–æ–≤–∫–∏.

---

## License
MIT (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî –∑–∞–º–µ–Ω–∏ –ø–æ–¥ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç)
